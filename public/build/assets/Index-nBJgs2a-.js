import{d as le,s as m,p as b,u as re,q as k,k as h,c as f,o as p,a as l,b as t,h as ie,w as n,e as s,i as w,f as c,t as o,F as $,r as ne}from"./app-WCoSBNF8.js";import{u as oe,c as x,T as u,_ as de,r as ue}from"./useServerDataTable-CC_X09HA.js";import{_}from"./index-gtYP4Z27.js";import{_ as N,a as F,b as Z,c as B,d as A,e as W}from"./DialogTitle.vue_vue_type_script_setup_true_lang-C5hn0Roi.js";import{_ as ce}from"./AppLayout.vue_vue_type_script_setup_true_lang-BkSasf_i.js";import{S as me}from"./square-pen-CqN4BlLM.js";import{P as fe}from"./plus-BaMQmwWi.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VisuallyHidden-CkRoF75v.js";import"./useForwardExpose-j55gvhwt.js";const ge={class:"space-y-6 p-6"},ve={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},be={class:"flex items-center space-x-0 sm:space-x-3"},xe={key:0,class:"space-y-4"},_e={class:"rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-800 dark:bg-red-900/20"},ye={class:"flex items-start space-x-2"},ke={class:"text-sm text-red-700 dark:text-red-300"},Ce={class:"text-xs"},Ie={class:"text-xs"},he={class:"mt-2 text-xs text-gray-700 dark:text-gray-300"},we={class:"mt-1 flex items-center"},De=["src"],Pe={class:"space-y-4"},Se={class:"rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-800 dark:bg-red-900/20"},$e={class:"flex items-start space-x-2"},Ne={class:"text-sm text-red-700 dark:text-red-300"},Fe={class:"max-h-40 overflow-y-auto text-sm text-gray-600 dark:text-gray-400"},Ze={class:"mt-1 space-y-1"},Be=le({__name:"Index",props:{certifications:{}},setup(j){const y=j,R=[{title:"Certifications",href:m("certifications.index")}],{handleSearch:E,handleSort:T,handlePageChange:z,handleFilter:H,clearFilters:L,refresh:C,loading:O}=oe({baseRoute:m("certifications.index"),defaultSort:{field:"certification_name",order:"asc"},defaultPerPage:15}),G=b([]),i=b(null),g=b(!1),v=b(!1),d=b([]),I=re({}),D=k(()=>{const r=Array.isArray(y.certifications?.data)?y.certifications.data:[],e=y.certifications?.meta?.per_page,a=y.certifications?.meta?.current_page,K=Number.isFinite(Number(e))&&Number(e)>0?Number(e):15,ee=((Number.isFinite(Number(a))&&Number(a)>0?Number(a):1)-1)*K;return r.map((te,ae)=>{const S=ee+ae+1,se=Number.isFinite(Number(S))?S:null;return{...te,serial:se}})}),M=k(()=>[x("employee","Employee",{sortable:!1,searchable:!0,render:(r,e)=>{const a=e.employee?`${e.employee.first_name??""} ${e.employee.last_name??""}`.trim()||`#${e.employee_id}`:`#${e.employee_id}`;return typeof e.serial=="number"&&Number.isFinite(e.serial)?`${e.serial}. ${a}`:a}}),x("certification_name","Certification",{sortable:!0,searchable:!0}),x("issuing_organization","Issuing Organization",{sortable:!0,searchable:!0}),x("issue_date","Issue Date",{sortable:!0,searchable:!1}),x("image_url","Certificate",{sortable:!1,searchable:!1,render:(r,e)=>(r&&console.log(`Rendering certificate image for ID ${e.id}:`,r),ue(r,`Certificate for ${e.certification_name}`,50)),class:"text-center"})]),U=k(()=>[{label:"Edit",icon:me,variant:"outline",tooltip:"Edit certification",onClick:r=>h.visit(m("certifications.edit",r.id)),class:"text-blue-600 hover:text-blue-700 border-blue-200 hover:border-blue-300"},{label:"Delete",icon:u,variant:"destructive",tooltip:"Delete certification",onClick:r=>Y(r.id),class:"text-red-600 hover:text-red-700"}]),V=k(()=>[{label:"Delete Selected",action:"delete",icon:u,variant:"destructive"}]);function Y(r){const e=D.value.find(a=>a.id===r);e&&(i.value=e,g.value=!0)}const Q=()=>{L(),G.value=[]};function X(){i.value&&I.delete(m("certifications.destroy",i.value.id),{preserveScroll:!0,onSuccess:()=>{g.value=!1,i.value=null,C()}})}function q(){d.value.length!==0&&h.post(m("certifications.bulk-destroy"),{ids:d.value.map(r=>r.id)},{preserveScroll:!0,onSuccess:()=>{v.value=!1,d.value=[],C()}})}const J=r=>{d.value=r.selectedRows,r.action==="delete"&&(v.value=!0)};function P(r){r.image_url&&window.open(r.image_url,"_blank")}return(r,e)=>(p(),f($,null,[l(t(ie),{title:"Certifications Management"}),l(ce,{breadcrumbs:R},{default:n(()=>[s("div",ge,[s("div",ve,[e[9]||(e[9]=s("div",null,[s("h1",{class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"},"Certifications"),s("p",{class:"text-gray-600 dark:text-gray-400"},"Manage employee certifications and their details.")],-1)),s("div",be,[l(t(_),{onClick:e[0]||(e[0]=a=>t(h).visit(t(m)("certifications.create"))),class:"flex w-full cursor-pointer items-center justify-center space-x-2 sm:w-auto"},{default:n(()=>[l(t(fe),{class:"h-4 w-4"}),e[8]||(e[8]=s("span",null,"Create Certification",-1))]),_:1})])]),l(de,{data:D.value,columns:M.value,actions:U.value,"bulk-actions":V.value,"total-records":r.certifications.meta.total,"current-page":r.certifications.meta.current_page,loading:t(O),"default-rows-per-page":15,searchable:"",sortable:"",paginator:"",filterable:"",exportable:"","selection-mode":"multiple",onSearch:t(E),onSort:t(T),onPageChange:t(z),onFilter:t(H),onClearFilters:Q,onRefresh:t(C),onBulkAction:J},null,8,["data","columns","actions","bulk-actions","total-records","current-page","loading","onSearch","onSort","onPageChange","onFilter","onRefresh"])]),l(t(N),{open:g.value,"onUpdate:open":e[5]||(e[5]=a=>g.value=a)},{default:n(()=>[l(t(F),{class:"sm:max-w-md"},{default:n(()=>[l(t(Z),null,{default:n(()=>[l(t(B),{class:"flex items-center space-x-2"},{default:n(()=>[l(t(u),{class:"h-5 w-5 text-red-500"}),e[10]||(e[10]=s("span",null,"Delete Certification",-1))]),_:1}),l(t(A),null,{default:n(()=>[...e[11]||(e[11]=[c(" Are you sure you want to delete this certification? This action cannot be undone. ",-1)])]),_:1})]),_:1}),i.value?(p(),f("div",xe,[s("div",_e,[s("div",ye,[l(t(u),{class:"mt-0.5 h-4 w-4 text-red-600 dark:text-red-400"}),s("div",ke,[s("strong",null,o(i.value.certification_name)+" — "+o(i.value.issuing_organization),1),e[13]||(e[13]=s("br",null,null,-1)),s("span",Ce,"Employee: "+o(i.value.employee&&((i.value.employee.first_name??"")+" "+(i.value.employee.last_name??"")).trim()||"#"+i.value.employee_id),1),e[14]||(e[14]=s("br",null,null,-1)),s("span",Ie,"Issue Date: "+o(i.value.issue_date??"N/A"),1),s("div",he,[e[12]||(e[12]=s("strong",null,"Certificate Image:",-1)),s("div",we,[i.value?.image_url?(p(),f("img",{key:0,src:i.value.image_url,alt:"Certificate",style:{"max-width":"100px","max-height":"100px"},class:"rounded border border-gray-200 hover:border-primary cursor-pointer",onClick:e[1]||(e[1]=a=>P(i.value)),onError:e[2]||(e[2]=a=>{console.error("Failed to load image in dialog:",i.value.image_url),a.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjZjVmNWY1IiAvPjx0ZXh0IHg9IjQwIiB5PSI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBhbGlnbm1lbnQtYmFzZWxpbmU9Im1pZGRsZSI+SW1hZ2UgTm90IEZvdW5kPC90ZXh0Pjwvc3ZnPg==",a.target.classList.add("opacity-60")})},null,40,De)):w("",!0),i.value?.image_url?(p(),f("small",{key:1,class:"ml-2 text-blue-600 dark:text-blue-400 cursor-pointer",onClick:e[3]||(e[3]=a=>P(i.value))}," Click to view full size ")):w("",!0)])])])])])])):w("",!0),l(t(W),{class:"space-x-2"},{default:n(()=>[l(t(_),{variant:"outline",onClick:e[4]||(e[4]=a=>g.value=!1),class:"cursor-pointer"},{default:n(()=>[...e[15]||(e[15]=[c("Cancel",-1)])]),_:1}),l(t(_),{variant:"destructive",onClick:X,loading:t(I).processing,class:"cursor-pointer"},{default:n(()=>[l(t(u),{class:"mr-2 h-4 w-4"}),e[16]||(e[16]=c(" Delete Certification ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["open"]),l(t(N),{open:v.value,"onUpdate:open":e[7]||(e[7]=a=>v.value=a)},{default:n(()=>[l(t(F),{class:"sm:max-w-lg"},{default:n(()=>[l(t(Z),null,{default:n(()=>[l(t(B),{class:"flex items-center space-x-2"},{default:n(()=>[l(t(u),{class:"h-5 w-5 text-red-500"}),e[17]||(e[17]=s("span",null,"Delete Multiple Certifications",-1))]),_:1}),l(t(A),null,{default:n(()=>[c(" Are you sure you want to delete "+o(d.value.length)+" selected certifications? This action cannot be undone. ",1)]),_:1})]),_:1}),s("div",Pe,[s("div",Se,[s("div",$e,[l(t(u),{class:"mt-0.5 h-4 w-4 text-red-600 dark:text-red-400"}),s("div",Ne,[s("strong",null,o(d.value.length)+" certifications",1),e[18]||(e[18]=c(" will be permanently deleted. ",-1))])])]),s("div",Fe,[e[19]||(e[19]=s("strong",null,"Certifications to be deleted:",-1)),s("ul",Ze,[(p(!0),f($,null,ne(d.value,a=>(p(),f("li",{key:a.id}," • "+o(a.certification_name)+" — "+o(a.issuing_organization)+" (Employee: "+o(a.employee&&((a.employee.first_name??"")+" "+(a.employee.last_name??"")).trim()||"#"+a.employee_id)+") ",1))),128))])])]),l(t(W),{class:"space-x-2"},{default:n(()=>[l(t(_),{variant:"outline",onClick:e[6]||(e[6]=a=>v.value=!1),class:"cursor-pointer"},{default:n(()=>[...e[20]||(e[20]=[c("Cancel",-1)])]),_:1}),l(t(_),{variant:"destructive",onClick:q,loading:t(I).processing,class:"cursor-pointer"},{default:n(()=>[l(t(u),{class:"mr-2 h-4 w-4"}),c(" Delete All ("+o(d.value.length)+") ",1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}}),Me=pe(Be,[["__scopeId","data-v-5c7ac6a7"]]);export{Me as default};
