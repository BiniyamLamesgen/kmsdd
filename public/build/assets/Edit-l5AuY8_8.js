import{d as z,s as p,u as j,q as Z,p as U,l as V,m as W,c as m,o as u,a as t,i as B,b as i,h as P,w as o,e as s,f as c,g as $,j as D,n as E,F as v,r as N,t as L,v as F,k as x}from"./app-BtxNwyw2.js";import{_}from"./index-jPyfy9EI.js";import{_ as O,a as H,b as A,c as G}from"./CardTitle.vue_vue_type_script_setup_true_lang-FN0ZLx45.js";import{_ as M}from"./CardDescription.vue_vue_type_script_setup_true_lang-kVO9wE2d.js";import{_ as f,a as g}from"./Label.vue_vue_type_script_setup_true_lang-C-ig4YK4.js";import{_ as R}from"./AppLayout.vue_vue_type_script_setup_true_lang-CXKSQ9h2.js";import{A as Y}from"./arrow-left-CdviPf8L.js";import{S as Q}from"./star-DRcTtEfk.js";import"./useForwardExpose-AmO87qx4.js";import"./VisuallyHidden-DfHmtx4U.js";const T={class:"mx-auto max-w-3xl space-y-6 p-6"},X={class:"flex items-center justify-between"},J={class:"flex items-center space-x-4"},q={class:"space-y-2"},K=["value"],ee={class:"space-y-2"},ie={class:"space-y-2"},te={class:"space-y-2"},ae={class:"space-y-2"},se={class:"mt-1 border rounded overflow-hidden",style:{"max-width":"150px","max-height":"100px"}},oe=["src"],ne={key:1,class:"w-full h-24 flex items-center justify-center text-xs text-gray-500"},le={class:"flex items-center justify-end space-x-4 border-t pt-6"},ve=z({__name:"Edit",props:{certification:{},employees:{}},setup(I){const l=I,b=[{title:"Certifications",href:p("certifications.index")},{title:"Edit",href:""}],a=j({employee_id:"",certification_name:"",issuing_organization:"",issue_date:"",image:null,_method:"POST"});console.log("Certification data received:",l.certification);const w=Z(()=>l.certification?.image_url?`${l.certification.image_url.replace("http://localhost/","http://127.0.0.1:8000/")}?t=${Date.now()}`:void 0),d=U(void 0);V(()=>{l.certification&&(a.employee_id=String(l.certification.employee_id??""),a.certification_name=l.certification.certification_name??"",a.issuing_organization=l.certification.issuing_organization??"",a.issue_date=l.certification.issue_date??"",d.value=w.value,console.log("Setting image preview to:",d.value))}),W(()=>l.certification,n=>{n&&(a.employee_id=String(n.employee_id??""),a.certification_name=n.certification_name??"",a.issuing_organization=n.issuing_organization??"",a.issue_date=n.issue_date??"",d.value=n.image_url??void 0)});function k(n){const e=n.target;e.files&&e.files[0]&&(a.image=e.files[0],d.value=URL.createObjectURL(e.files[0]))}function C(n){const e=n.target;console.error("Image failed to load:",d.value),e.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjZjVmNWY1IiAvPjx0ZXh0IHg9IjQwIiB5PSI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBhbGlnbm1lbnQtYmFzZWxpbmU9Im1pZGRsZSI+SW1hZ2UgTm90IEZvdW5kPC90ZXh0Pjwvc3ZnPg=="}function h(){d.value&&window.open(d.value,"_blank")}function S(){a.post(p("certifications.update",l.certification.id),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>x.visit(p("certifications.index"))})}function y(){x.visit(p("certifications.index"))}return(n,e)=>(u(),m(v,null,[t(i(P),{title:"Edit Certification"}),t(R,{breadcrumbs:b},{default:o(()=>[s("div",T,[s("div",X,[s("div",J,[t(i(_),{variant:"outline",size:"sm",onClick:y,class:"cursor-pointer"},{default:o(()=>[t(i(Y),{class:"mr-2 h-4 w-4"}),e[4]||(e[4]=c(" Back ",-1))]),_:1}),e[5]||(e[5]=s("div",null,[s("h1",{class:"text-2xl font-semibold text-gray-900 dark:text-gray-100"}," Edit Certification "),s("p",{class:"text-gray-600 dark:text-gray-400"}," Update certification details and upload certificate image. ")],-1))])]),s("form",{onSubmit:$(S,["prevent"]),class:"space-y-6",enctype:"multipart/form-data"},[t(i(O),null,{default:o(()=>[t(i(H),null,{default:o(()=>[t(i(A),{class:"flex items-center space-x-2"},{default:o(()=>[t(i(Q),{class:"h-5 w-5"}),e[6]||(e[6]=s("span",null,"Certification Information",-1))]),_:1}),t(i(M),null,{default:o(()=>[...e[7]||(e[7]=[c(" Update the fields below and click save. ",-1)])]),_:1})]),_:1}),t(i(G),{class:"space-y-4"},{default:o(()=>[s("div",q,[t(i(f),{for:"employee_id"},{default:o(()=>[...e[8]||(e[8]=[c("Employee *",-1)])]),_:1}),D(s("select",{id:"employee_id","onUpdate:modelValue":e[0]||(e[0]=r=>i(a).employee_id=r),class:E(["w-full rounded border border-gray-300 bg-white px-3 py-2 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100"])},[e[9]||(e[9]=s("option",{value:"",disabled:""}," Select employee ",-1)),(u(!0),m(v,null,N(l.employees,r=>(u(),m("option",{key:r.id,value:r.id},L(r.name),9,K))),128))],512),[[F,i(a).employee_id]])]),s("div",ee,[t(i(f),{for:"certification_name"},{default:o(()=>[...e[10]||(e[10]=[c("Certification Name",-1)])]),_:1}),t(i(g),{id:"certification_name",modelValue:i(a).certification_name,"onUpdate:modelValue":e[1]||(e[1]=r=>i(a).certification_name=r),placeholder:"Certification name"},null,8,["modelValue"])]),s("div",ie,[t(i(f),{for:"issuing_organization"},{default:o(()=>[...e[11]||(e[11]=[c("Issuing Organization",-1)])]),_:1}),t(i(g),{id:"issuing_organization",modelValue:i(a).issuing_organization,"onUpdate:modelValue":e[2]||(e[2]=r=>i(a).issuing_organization=r),placeholder:"Organization"},null,8,["modelValue"])]),s("div",te,[t(i(f),{for:"issue_date"},{default:o(()=>[...e[12]||(e[12]=[c("Issue Date",-1)])]),_:1}),t(i(g),{id:"issue_date",modelValue:i(a).issue_date,"onUpdate:modelValue":e[3]||(e[3]=r=>i(a).issue_date=r),type:"date"},null,8,["modelValue"])]),s("div",ae,[t(i(f),{for:"image"},{default:o(()=>[...e[13]||(e[13]=[c("Certificate Image",-1)])]),_:1}),t(i(g),{id:"image",type:"file",onChange:k}),s("div",se,[d.value?(u(),m("img",{key:0,src:d.value,alt:"Certificate Image",class:"max-w-full max-h-24 object-contain cursor-pointer hover:opacity-80",onError:C,onClick:h,title:"Click to view full size"},null,40,oe)):(u(),m("div",ne," No image preview "))]),e[14]||(e[14]=s("div",{class:"mt-1 text-xs text-gray-500"},[s("span",{class:"italic"},"Click image to view full size")],-1))])]),_:1})]),_:1}),s("div",le,[t(i(_),{type:"button",variant:"outline",onClick:y,class:"cursor-pointer"},{default:o(()=>[...e[15]||(e[15]=[c(" Cancel ",-1)])]),_:1}),t(i(_),{type:"submit",loading:i(a).processing,class:"cursor-pointer"},{default:o(()=>[...e[16]||(e[16]=[c(" Update Certification ",-1)])]),_:1},8,["loading"])])],32)])]),_:1}),B("",!0)],64))}});export{ve as default};
