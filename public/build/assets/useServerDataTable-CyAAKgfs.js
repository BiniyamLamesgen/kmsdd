import{d as re,q as M,c as b,o as i,K as ue,n as W,H as $,p as F,l as de,m as B,i as g,a as y,t as D,b as n,ak as ce,al as V,w as f,e as z,am as he,A as p,an as U,F as Z,r as E,C as H,ao as ae,R as fe,j as ve,V as me,ap as S,aq as pe,ar as ge,as as ye,at as be,au as ke,av as O,k as Y}from"./app-B8cnIyhQ.js";import{c as R}from"./index-C4qItS30.js";import{P as Fe}from"./plus-BlhWpQ8-.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=R("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=R("funnel-x",[["path",{d:"M12.531 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14v6a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341l.427-.473",key:"ol2ft2"}],["path",{d:"m16.5 3.5 5 5",key:"15e6fa"}],["path",{d:"m21.5 3.5-5 5",key:"m0lwru"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=R("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=R("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=R("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=R("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Re=re({__name:"Badge",props:{variant:{}},setup(a){const t=a,l=M(()=>{switch(t.variant){case"secondary":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200";case"destructive":return"bg-red-100 text-red-800 dark:bg-red-700 dark:text-red-200";case"outline":return"border border-gray-300 text-gray-800 dark:border-gray-600 dark:text-gray-200 bg-transparent";default:return"bg-blue-100 text-blue-800 dark:bg-blue-700 dark:text-blue-200"}});return(m,u)=>(i(),b("span",{class:W(["inline-flex items-center px-2.5 py-0.5 rounded text-xs font-medium",l.value])},[ue(m.$slots,"default")],2))}});function Ie(a,t="Active",l="Inactive",m="default",u="destructive"){return $(Re,{variant:a?m:u},{default:()=>a?t:l})}function Ye(a,t="Document Image",l=40){return a?$("img",{src:a,alt:t,style:`width:${l}px;height:${l}px;object-fit:cover;border-radius:6px;`,loading:"lazy"}):"-"}function le(a,t="MMM DD, YYYY"){if(!a)return"-";const l=new Date(a);return isNaN(l.getTime())?"-":l.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"})}function Ae(a,t="USD",l="en-US"){return a==null?"-":new Intl.NumberFormat(l,{style:"currency",currency:t}).format(a)}function je(a,t=50){return a?a.length<=t?a:$("span",{title:a},a.substring(0,t)+"..."):"-"}function P(a,t,l={}){return{key:a,label:t,sortable:l.sortable??!0,searchable:l.searchable??!0,width:l.width,render:l.render,class:l.class,headerClass:l.headerClass}}const Ge={checkbox:{key:"checkbox",label:"",sortable:!1,searchable:!1,width:"50px",class:"text-center",headerClass:"text-center"},id:()=>P("id","ID",{width:"80px",class:"text-center",headerClass:"text-center"}),name:()=>P("name","Name"),email:()=>P("email","Email"),status:(a="is_active")=>P(a,"Status",{sortable:!0,searchable:!1,width:"120px",render:t=>Ie(t),class:"text-center",headerClass:"text-center"}),createdAt:(a="created_at")=>P(a,"Created",{sortable:!0,searchable:!1,width:"140px",render:t=>le(t)}),updatedAt:(a="updated_at")=>P(a,"Updated",{sortable:!0,searchable:!1,width:"140px",render:t=>le(t)}),description:(a=100)=>P("description","Description",{sortable:!1,render:t=>je(t,a)}),amount:(a="amount",t="USD")=>P(a,"Amount",{sortable:!0,searchable:!1,width:"120px",render:l=>Ae(l,t),class:"text-right",headerClass:"text-right"})};function _e(a,t="Certificate",l=50){return a?$("div",{class:"flex items-center justify-center",style:`min-width:${l}px;min-height:${l}px;`},[$("img",{src:a,alt:t,class:"transition-all duration-200 hover:scale-110",style:`max-width:${l}px;max-height:${l}px;border-radius:4px;border:1px solid #eee;object-fit:cover;`,loading:"lazy",onclick:()=>window.open(a,"_blank"),onerror:m=>{const u=m.target;console.error("Failed to load image:",a),u.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjZjVmNWY1IiAvPjx0ZXh0IHg9IjQwIiB5PSI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBhbGlnbm1lbnQtYmFzZWxpbmU9Im1pZGRsZSI+SW1hZ2UgTm90IEZvdW5kPC90ZXh0Pjwvc3ZnPg==",u.classList.add("error-image"),u.style.opacity="0.6"}})]):"-"}const De={class:"space-y-6"},Be={key:0,class:"space-y-1"},$e={key:0,class:"text-2xl font-bold tracking-tight"},Ne={key:1,class:"text-sm"},Oe={key:2,class:"flex items-center gap-2"},Te={class:"relative"},Le={key:1},Ve={class:"flex items-center justify-center gap-1"},ze={key:0,class:"text-xs"},Ue={class:"px-4 py-3 text-center text-sm"},Xe=re({__name:"ServerDataTable",props:{data:{},columns:{},actions:{default:()=>[]},totalRecords:{},loading:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},sortable:{type:Boolean,default:!0},paginator:{type:Boolean,default:!0},selectionMode:{default:null},filterable:{type:Boolean,default:!0},exportable:{type:Boolean,default:!1},columnsToggle:{type:Boolean,default:!0},title:{},subtitle:{},createRoute:{},createLabel:{default:"Add New"},striped:{type:Boolean,default:!0},hoverable:{type:Boolean,default:!0},bordered:{type:Boolean,default:!0},responsive:{type:Boolean,default:!0},size:{default:"normal"},rowsPerPageOptions:{default:()=>[5,8,10,25,50,100]},defaultRowsPerPage:{default:8},currentPage:{default:1},globalFilterFields:{default:()=>[]},emptyMessage:{default:"No records found"},bulkActions:{default:()=>[]},onSearch:{},onSort:{},onPageChange:{},onSelectionChange:{},onFilter:{},onExport:{}},emits:["bulkAction","search","filter","clearFilters","refresh","sort","pageChange","selectionChange","export"],setup(a,{emit:t}){const l=a,m=t,u=F(),v=F(null),k=F({}),I=F(l.columns.map(e=>e.key)),A=F(""),j=F(l.defaultRowsPerPage),w=F((l.currentPage-1)*l.defaultRowsPerPage),N=F(!1),G=()=>{const e={};l.searchable&&(e.global={value:null,matchMode:O.CONTAINS}),l.columns.forEach(o=>{o.searchable!==!1&&(e[o.key]={value:null,matchMode:O.CONTAINS})}),k.value=e};de(()=>{G()});const x=M(()=>Array.isArray(v.value)?v.value.length>0:v.value!==null&&v.value!==void 0),_=M(()=>Array.isArray(v.value)?v.value.length:x.value?1:0),X=M(()=>l.columns.map(e=>({label:e.label,value:e.key}))),q=M(()=>l.columns.filter(e=>I.value.includes(e.key)));M(()=>w.value);const Q=M(()=>{const e=[];return l.striped&&e.push("p-datatable-striped"),l.hoverable&&e.push("p-datatable-hoverable"),l.size==="small"&&e.push("p-datatable-sm"),l.size==="large"&&e.push("p-datatable-lg"),e.join(" ")});B(A,e=>{k.value.global&&(k.value.global.value=e),m("search",e)}),B(k,e=>{Object.keys(e).forEach(o=>{const s=e[o];s?.value&&o!=="global"&&s.value})},{deep:!0}),B(()=>l.currentPage,e=>{w.value=(e-1)*j.value}),B(()=>l.defaultRowsPerPage,e=>{j.value=e,w.value=(l.currentPage-1)*e});const J=e=>{const{sortField:o,sortOrder:s}=e;m("sort",o,s===1?"asc":"desc")},K=e=>{w.value=e.first,j.value=e.rows;const o=Math.floor(e.first/e.rows)+1;m("pageChange",o,e.rows)},T=()=>{m("selectionChange",v.value)},r=(e,o)=>{e.onClick(o)},h=(e,o)=>e.show?e.show(o):!0,d=(e,o)=>o.render?o.render(e[o.key],e):e[o.key],C=()=>{l.createRoute&&Y.visit(l.createRoute)},se=()=>{w.value=0,v.value=l.selectionMode==="multiple"?[]:null,Y.reload({only:["billingCycles"]}),m("refresh")},oe=()=>{A.value="";const e={};l.searchable&&(e.global={value:null,matchMode:O.CONTAINS}),l.columns.forEach(o=>{o.searchable!==!1&&(e[o.key]={value:null,matchMode:O.CONTAINS})}),k.value=e,w.value=0,v.value=l.selectionMode==="multiple"?[]:null,m("clearFilters")},ne=()=>{v.value=l.selectionMode==="multiple"?[]:null,T()},ee=e=>{x.value&&m("bulkAction",{action:e,selectedRows:Array.isArray(v.value)?v.value:[v.value]})},ie=e=>{N.value=!0,u.value&&u.value.exportCSV(),m("export",e),setTimeout(()=>{N.value=!1},1e3)},te=e=>{switch(e){case"destructive":return"danger";case"outline":return"secondary";case"secondary":return"secondary";case"default":return"info";default:return"info"}};return(e,o)=>(i(),b("div",De,[e.title||e.subtitle?(i(),b("div",Be,[e.title?(i(),b("h2",$e,D(e.title),1)):g("",!0),e.subtitle?(i(),b("p",Ne,D(e.subtitle),1)):g("",!0)])):g("",!0),y(n(ce),null,V({header:f(()=>[y(n(pe),null,{start:f(()=>[x.value?(i(),p(n(ke),{key:0,value:`${_.value} selected`,severity:"info",class:"mr-2"},null,8,["value"])):g("",!0),x.value?(i(),p(n(S),{key:1,label:"Clear",severity:"secondary",size:"small",text:"",class:"mr-2",onClick:ne},{icon:f(()=>[y(n(we),{class:"h-3 w-3"})]),_:1})):g("",!0),x.value?(i(),b("div",Oe,[(i(!0),b(Z,null,E(e.bulkActions,s=>(i(),p(n(S),{key:s.action,label:s.label,severity:te(s.variant),size:"small",outlined:"",onClick:c=>ee(s.action)},{icon:f(()=>[(i(),p(H(s.icon),{class:"h-3 w-3"}))]),_:2},1032,["label","severity","onClick"]))),128)),!e.bulkActions||e.bulkActions.length===0?(i(),p(n(S),{key:0,label:"Delete Selected",severity:"danger",size:"small",outlined:"",onClick:o[0]||(o[0]=s=>ee("delete"))},{icon:f(()=>[y(n(xe),{class:"h-3 w-3"})]),_:1})):g("",!0)])):g("",!0)]),center:f(()=>[e.searchable?(i(),p(n(be),{key:0,iconPosition:"left"},{default:f(()=>[y(n(ye),null,{default:f(()=>[y(n(Me),{class:"h-4 w-4"})]),_:1}),y(n(ae),{modelValue:A.value,"onUpdate:modelValue":o[1]||(o[1]=s=>A.value=s),placeholder:"Search..."},null,8,["modelValue"])]),_:1})):g("",!0)]),end:f(()=>[e.filterable?(i(),p(n(S),{key:0,severity:"secondary",outlined:"",size:"small",class:"mr-2",onClick:oe,badge:Object.values(k.value).some(s=>s?.value)?"1":void 0,title:"Clear Filters"},{icon:f(()=>[y(n(Se),{class:"h-3 w-3"})]),_:1},8,["badge"])):g("",!0),e.columnsToggle?(i(),p(n(ge),{key:1,modelValue:I.value,"onUpdate:modelValue":o[2]||(o[2]=s=>I.value=s),options:X.value,optionLabel:"label",optionValue:"value",placeholder:"Columns",class:"mr-2",maxSelectedLabels:0,selectedItemsLabel:`${I.value.length} columns`,title:"Toggle Column Visibility"},null,8,["modelValue","options","selectedItemsLabel"])):g("",!0),e.exportable?(i(),p(n(S),{key:2,severity:"secondary",outlined:"",size:"small",class:"mr-2",onClick:o[3]||(o[3]=s=>ie("csv")),loading:N.value,title:"Export to CSV"},{icon:f(()=>[y(n(Ce),{class:"h-3 w-3"})]),_:1},8,["loading"])):g("",!0),y(n(S),{severity:"secondary",outlined:"",size:"small",class:"mr-2",onClick:se,loading:e.loading,title:"Refresh Data"},{icon:f(()=>[y(n(Pe),{class:"h-3 w-3"})]),_:1},8,["loading"]),e.createRoute?(i(),p(n(S),{key:3,label:e.createLabel,size:"small",onClick:C,title:"Add New Record"},{icon:f(()=>[y(n(Fe),{class:"h-3 w-3"})]),_:1},8,["label"])):g("",!0)]),_:1})]),content:f(()=>[z("div",Te,[y(n(he),{ref_key:"dt",ref:u,selection:v.value,"onUpdate:selection":o[4]||(o[4]=s=>v.value=s),filters:k.value,"onUpdate:filters":o[5]||(o[5]=s=>k.value=s),value:e.data,loading:e.loading,class:W(Q.value),sortMode:e.sortable?"single":void 0,selectionMode:e.selectionMode||void 0,globalFilterFields:e.globalFilterFields,emptyMessage:e.emptyMessage,scrollable:!0,scrollHeight:"55vh",resizableColumns:!0,columnResizeMode:"expand",filterDisplay:"menu",paginator:e.paginator,rows:j.value,totalRecords:e.totalRecords||e.data.length,first:w.value,rowsPerPageOptions:e.rowsPerPageOptions,paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} to {last} of {totalRecords} entries",lazy:!0,onSort:J,onSelectionChange:T,onPage:K,tableStyle:"min-width: 50rem",dataKey:"id"},{default:f(()=>[e.selectionMode?(i(),p(n(U),{key:0,selectionMode:"multiple",headerStyle:"width: 3rem",exportable:!1})):g("",!0),(i(!0),b(Z,null,E(q.value,s=>(i(),p(n(U),{key:s.key,field:s.key,header:s.label,sortable:e.sortable&&s.sortable!==!1,showFilterMatchModes:!1,filterMenuStyle:{width:"14rem"},style:fe(s.width?{width:s.width,minWidth:s.width}:void 0),exportable:s.key!=="actions"},V({body:f(({data:c})=>[typeof d(c,s)=="object"?(i(),p(H(typeof d(c,s)=="object"?d(c,s):"span"),{key:0})):(i(),b("span",Le,D(d(c,s)),1))]),_:2},[e.filterable&&s.searchable!==!1?{name:"filter",fn:f(({filterModel:c})=>[y(n(ae),{modelValue:c.value,"onUpdate:modelValue":L=>c.value=L,type:"text",class:"p-column-filter",placeholder:`Search by ${s.label}`},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),key:"0"}:void 0]),1032,["field","header","sortable","style","exportable"]))),128)),e.actions&&e.actions.length>0?(i(),p(n(U),{key:1,header:"Actions",exportable:!1,headerStyle:"width: 8rem; text-align: center",bodyStyle:"text-align: center",alignFrozen:"right"},{body:f(({data:s})=>[z("div",Ve,[(i(!0),b(Z,null,E(e.actions,(c,L)=>ve((i(),p(n(S),{key:L,icon:c.icon?"pi pi-"+(c.variant==="destructive"?"trash":"pencil"):void 0,severity:te(c.variant),outlined:c.variant==="outline",size:"small",class:W(c.class),title:c.tooltip||c.label||"Action",onClick:Ze=>r(c,s)},V({default:f(()=>[!c.icon&&c.label?(i(),b("span",ze,D(c.label),1)):g("",!0)]),_:2},[c.icon?{name:"icon",fn:f(()=>[(i(),p(H(c.icon),{class:"h-3 w-3"}))]),key:"0"}:void 0]),1032,["icon","severity","outlined","class","title","onClick"])),[[me,h(c,s)]])),128))])]),_:1})):g("",!0)]),_:1},8,["selection","filters","value","loading","class","sortMode","selectionMode","globalFilterFields","emptyMessage","paginator","rows","totalRecords","first","rowsPerPageOptions"])])]),_:2},[!e.paginator&&e.emptyMessage&&e.data.length===0?{name:"footer",fn:f(()=>[z("div",Ue,D(e.emptyMessage),1)]),key:"0"}:void 0]),1024)]))}});function qe(a){const t=F({search:"",sortField:a.defaultSort?.field||null,sortOrder:a.defaultSort?.order||"asc",page:1,perPage:a.defaultPerPage||10,filters:{},columnFilters:{},dateRangeFilters:{}}),l=F(!1),m=()=>{const r={page:t.value.page,per_page:t.value.perPage};if(t.value.search&&t.value.search.trim()!==""&&(r.search=t.value.search),t.value.sortField&&(r.sort=t.value.sortField,r.order=t.value.sortOrder),Object.entries(t.value.filters).forEach(([h,d])=>{d!=null&&d!==""&&String(d).trim()!==""&&(r[h]=String(d))}),Object.entries(t.value.columnFilters).forEach(([h,d])=>{d!=null&&d!==""&&String(d).trim()!==""&&(r[h]=String(d))}),Object.entries(t.value.dateRangeFilters).forEach(([h,d])=>{d.from&&(r[`${h}_from`]=d.from),d.to&&(r[`${h}_to`]=d.to)}),a.columns){const h=a.columns.filter(C=>C.searchable!==!1).map(C=>C.key),d=a.columns.filter(C=>C.sortable!==!1).map(C=>C.key);h.length>0&&(r.searchable_columns=h.join(",")),d.length>0&&(r.sortable_columns=d.join(","))}return r},u=(r=!1)=>{r&&(t.value.page=1),l.value=!0,Y.get(a.baseRoute,m(),{preserveState:a.preserveState??!0,preserveScroll:a.preserveScroll??!0,onFinish:()=>{l.value=!1}})};let v;const k=()=>{clearTimeout(v),v=setTimeout(()=>{u(!0)},a.debounceMs||300)};return B(()=>t.value.search,()=>{k()}),{state:t,loading:l,handleSearch:r=>{t.value.search=r},handleSort:(r,h)=>{t.value.sortField=r,t.value.sortOrder=h,u()},handlePageChange:(r,h)=>{t.value.page=r,t.value.perPage=h,u()},handleFilter:r=>{t.value.filters={...t.value.filters,...r},u(!0)},setFilter:(r,h)=>{t.value.filters[r]=h,u(!0)},removeFilter:r=>{delete t.value.filters[r],u(!0)},setColumnFilter:(r,h)=>{t.value.columnFilters[r]=h,u(!0)},removeColumnFilter:r=>{delete t.value.columnFilters[r],u(!0)},setDateRangeFilter:(r,h,d)=>{t.value.dateRangeFilters[r]={from:h,to:d},u(!0)},removeDateRangeFilter:r=>{delete t.value.dateRangeFilters[r],u(!0)},batchUpdateFilters:r=>{r.filters&&(t.value.filters={...t.value.filters,...r.filters}),r.columnFilters&&(t.value.columnFilters={...t.value.columnFilters,...r.columnFilters}),r.dateRangeFilters&&(t.value.dateRangeFilters={...t.value.dateRangeFilters,...r.dateRangeFilters}),u(!0)},clearFilters:()=>{t.value.filters={},t.value.columnFilters={},t.value.dateRangeFilters={},t.value.search="",t.value.page=1,u()},refresh:()=>{u()},reset:()=>{t.value={search:"",sortField:a.defaultSort?.field||null,sortOrder:a.defaultSort?.order||"asc",page:1,perPage:a.defaultPerPage||10,filters:{},columnFilters:{},dateRangeFilters:{}},u()},fetchData:u}}export{Ge as C,xe as T,Xe as _,Ye as a,P as c,_e as r,qe as u};
